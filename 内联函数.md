---
title: 内联函数 
tags: 宏,C++,内联函数,入门
grammar_cjkRuby: true
---
[toc]
<font size = 4>

# 内联函数与宏的区别
1. 内联函数在运行时可调试，而宏定义不可以;
2. 编译器会对内联函数的参数类型做安全检查或自动类型转换（同普通函数），而宏定义则不会； 
3. 内联函数可以访问类的成员变量，宏定义则不能； 
4. 在类中声明同时定义的成员函数，自动转化为内联函数。

# 什么是内联函数
内联函数是C++的增强特性之一，用来降低程序的运行时间。当内联函数收到编译器的指示时，即可发生内联：编译器将使用函数的定义体来替代函数调用语句，这种替代行为发生在编译阶段而非程序运行阶段。
		
值得注意的是，内联函数仅仅是对编译器的内联建议，编译器是否觉得采取你的建议取决于函数是否符合内联的有利条件。如何函数体非常大，那么编译器将忽略函数的内联声明，而将内联函数作为普通函数处理。
# 如何使用内联函数
关键字**inline**必须与函数定义体放在一起才能使函数成为内联，仅将**inline**放在函数声明前面不起任何作用。
```cpp
Class A
{
 Public:
    int add(int a, int b)   //在类声明的时候定义函数，则该函数默认为inline函数
    {
       return (a + b);
    };
}

Class B
{
 Public:
    int add(int a, int b);
};

inline int A::add(int a, int b)
{
   return (a + b);
}
```

# inline函数的优缺点分析
**优点：**
- 它通过避免函数调用所带来的开销来提高你程序的运行速度。
- 当函数调用发生时，它节省了变量弹栈、压栈的开销。
- 它避免了一个函数执行完返回原现场的开销。
- 通过将函数声明为内联，你可以把函数定义放在头文件内。

**缺点：**
- 因为代码的扩展，内联函数增大了可执行程序的体积。
- C++内联函数的展开是中编译阶段，这就意味着如果你的内联函数发生了改动，那么就需要重新编译代码。
- 当你把内联函数放在头文件中时，它将会使你的头文件信息变多，不过头文件的使用者不用在意这些。
- 有时候内联函数并不受到青睐，比如在嵌入式系统中，嵌入式系统的存储约束可能不允许体积很大的可执行程序。

# 什么时候该使用内联函数
当程序设计需要时，每个函数都可以声明为inline。下面列举一些有用的建议：

1. 当对程序执行性能有要求时，那么就使用内联函数吧。
2. 当你想宏定义一个函数时，那就果断使用内联函数吧。
3. 在类内部定义的函数会默认声明为inline函数，这有利于 类实现细节的隐藏。

# 内联函数与宏
## 1. 使用宏
在C中，常用预处理语句`#define`来代替一个函数定义。例如：
　　`#define MAX(a，b) ((a)>(b)?(a):(b))`
该语句使得程序中每个出现MAX(a,b)函数调用的地方都被宏定义中后面的表达式((a)>(b)?(a):(b))所替换。宏定义语句的书写格式有过分的讲究，MAX与括号之间不能有空格，所有的参数都要放在括号里。尽管如此，它还是有麻烦：
```cpp
int a=1，b=0；
MAX(a++,b)； //a被增值2次
MAX(a++,b+10)； //a被增值1次
MAX(a,"Hello")； //错误地比较int和字符串，没有参数类型检查
```

## 2. 内联函数与宏的区别
1. 内联函数在运行时可调试，而宏定义不可以;
2. 编译器会对内联函数的参数类型做安全检查或自动类型转换（同普通函数），而宏定义则不会； 
3. 内联函数可以访问类的成员变量，宏定义则不能； 
4. 在类中声明同时定义的成员函数，自动转化为内联函数。

</font>
